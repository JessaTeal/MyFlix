{"dependencies":[{"name":"jsonwebtoken","loc":{"line":3,"column":20}},{"name":"passport","loc":{"line":4,"column":21}},{"name":"./passport.js","loc":{"line":6,"column":8}}],"generated":{"js":"const jwtSecret = 'your_jwt_secret';\n\nconst jwt = require('jsonwebtoken'),\n  passport = require('passport');\n\nrequire('./passport.js');\n\nlet generateJWTToken = (user) => {\n  return jwt.sign(user, jwtSecret, {\n    subject: user.Username,\n    expiresIn: '7d',\n    algorithm: 'HS256',\n  });\n}\n\nmodule.exports = (router) => {\n  router.post('/login', (req, res) => {\n    passport.authenticate('local', {session: false}, (error, user, info) => {\n      if (error || !user) {\n        return res.status(400).json({\n          message: 'Something is not right',\n          user: user\n        });\n      }\n      req.login(user, {session: false}, (error) => {\n        if(error) {\n          res.send(error);\n        }\n        let token = generateJWTToken(user.toJSON());\n        return res.json({user, token});\n      });\n    })(req, res);\n  });\n}\n"},"hash":"3f833d6176dec8b653d9270fbb2ded36"}